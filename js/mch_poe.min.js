jQuery(function(a){var h={myIframe:null,scrollPosition:0,$postPreviewBtn:null,animationDuration:500,interval:3E3,userIsActive:!1,reloadTimer:null,resizeTimer:null,autoClicking:!1,editorContainer:a("#wpwrap"),postBodyClass:null,init:function(){var b=this;b.addViewer();var c=setInterval(function(){if(0<b.$postPreviewBtn.length)clearInterval(c);else{var d=a("#post-preview");0<d.length?(clearInterval(c),b.addViewer()):(d=a(".editor-post-preview.is-button"),console.log("$postPreview="+d.length),0<d.length&&
(clearInterval(c),b.addViewer()))}},1E3)},addViewer:function(){var b=this;b.$postPreviewBtn=a("#post-preview");console.log(b.$postPreviewBtn);0===b.$postPreviewBtn.length&&(b.$postPreviewBtn=a(".editor-post-preview.is-button"),console.log(b.$postPreviewBtn));var c=b.$postPreviewBtn.attr("href");if(void 0!==c){b.$postPreviewBtn.on("click",function(a){console.log(this);setTimeout(function(){b.reloadMyPreview()},500)});var d=c.split("?");2===d.length&&"p=7"===d[1]&&(c+="preview=true");console.log("previewHref="+
c);c=a("<div/>").attr("id","mch-poe-preview-container").append(a("<iframe/>").attr("id","preview-on-editor-iframe").attr("src",c).attr("style","height: calc(100% - 35px);")).append('<div id="mch-poe-bottom"><span id="mch-poe-reload-btn" class="button">Reload</span></div>');a("#wpbody-content .wrap").addClass("mch-main-editor-area");a("#wpbody-content").after(c);b.myIframe=a("#preview-on-editor-iframe");b.myIframe.on("load",function(){var c=a(b.myIframe)[0].contentWindow;c.rtprScrollTo(b.scrollPosition);
c.rtprScrollCallBack(function(a){b.scrollPosition=a})});a("#mch-poe-reload-btn").on("click",function(c){console.log("btn click");wp.editor.PostPreviewButton();console.log("@@@@@@@@@@@@@@@@@@@@@@@ 5555555555");console.dir(wp);console.log("@@@@@@@@@@@@@@@@@@@@@@@ 5555555555");c=a(".editor-post-preview.is-button");console.log(c);console.log(b.$postPreviewBtn);b.$postPreviewBtn.click()})}},reloadMyPreview:function(){if(null===this.myIframe)return!0;var a=this.myIframe.attr("src");this.myIframe.attr("src",
"");this.myIframe.attr("src",a)},preview:function(){var b=this;if(!(0<a("#inline-preview-container").length)){a("body").addClass("inline-preview");var c=a("<div/>").attr("id","inline-preview-container").hide().append(a("<iframe/>").attr("id","inline-preview-iframe").attr("name",a("#post-preview").attr("target")||"wp-preview"));b.editorContainer.before(c);a("#post-body").hasClass("columns-2")?(b.postBodyClass="columns-2",a("#post-body").removeClass("columns-2").addClass("columns-1")):b.postBodyClass=
"columns-1";c.addClass("loading");this.setContainerWidth(!0);c.resizable({minWidth:100,handles:"w",start:function(){c.css("z-index","")},resize:function(a,e){c.parent().width();b.editorContainer.css("padding-right",e.size.width)},stop:function(a,b){a=c.parent().width();localStorage["inline-preview-width"]=Math.round(b.size.width/a*100);c.css("z-index","1000")}});a("#inline-preview-iframe").on("load.inline-preview",function(){b.userIsActive=!1;c.removeClass("loading");var d=a(this).attr("name");a(this).unbind("load.inline-preview").removeAttr("name");
a("#inline-preview-container").append(a('<iframe id="inline-preview-hidden-iframe"></iframe>').attr("name",d))});a(document).on("keydown.inline-preview click.inline-preview",function(){b.autoClicking||(b.userIsActive=!0)});a(window).on("resize.inline-preview",function(a){a.target==window&&(clearTimeout(b.resizeTimeout),b.resizeTimeout=setTimeout(function(){b.setContainerWidth()},250))});b.reloadTimer=setTimeout(function(){b.reload()},b.interval)}},setContainerWidth:function(b){var c=this,d=a("#inline-preview-container"),
e=a(document).width();b&&d.css("left",e).show();var f=60;localStorage["inline-preview-width"]&&(f=100-localStorage["inline-preview-width"]);var g=Math.round(f/100*e);e=Math.round((100-f)/100*e);d.css("width",e);b?(this.editorContainer.animate({"padding-right":e},{duration:c.animationDuration,queue:!1}),d.animate({left:g},{duration:c.animationDuration,queue:!1,complete:function(){d.append(a('<a id="inline-preview-close"  class="media-modal-close"><span class="media-modal-icon"></span></a>').on("click.inline-preview",
function(a){a.preventDefault();c.remove()}).attr("title",Inline_Preview_Strings.close)).css("z-index","1000");a(window).scroll()}})):(this.editorContainer.css("padding-right",e),d.css("left",g))},setTimer:function(){var a=this;clearTimeout(this.reloadTimer);this.reloadTimer=setTimeout(function(){a.reload()},this.interval)},reload:function(){var b=this;if(this.userIsActive){this.userIsActive=!1;var c=a("#inline-preview-hidden-iframe");this.autoClicking=!0;a("#post-preview").click();this.autoClicking=
!1;c.on("load.inline-preview",function(){a(this).off("load.inline-preview");var d=a("#inline-preview-iframe"),e=a(d.get(0).contentWindow).scrollTop();c.show();a(c.get(0).contentWindow).scrollTop(e);d.remove();d=c.attr("name");c.attr("name","").attr("id","inline-preview-iframe");a("#inline-preview-container").append(a('<iframe id="inline-preview-hidden-iframe"></iframe>').attr("name",d));b.setTimer()});setTimeout(function(){b.setTimer()},15E3)}else this.setTimer()},remove:function(){var b=this;a(document).off(".inline-preview");
a(window).off(".inline-preview");a("#inline-preview-close").hide();a("#inline-preview-container").animate({left:a(window).width()},{duration:b.animationDuration,queue:!1,complete:function(){a("#post-body").removeClass("columns-1").addClass(b.postBodyClass);b.postBodyClass=null;a("#inline-preview-container").remove();a("body").removeClass("inline-preview");a(window).scroll()}});a("#wpwrap").animate({"padding-right":"0"},{duration:b.animationDuration,queue:!1});clearTimeout(this.reloadTimer);clearTimeout(this.resizeTimer)}};
a(document).ready(function(){console.log("333333333333");h.init()})});$(document).ready(function(){});(function(){console.log("@@@@@@@@@@@@@@@@@@@@@@@ 333333333")})();
